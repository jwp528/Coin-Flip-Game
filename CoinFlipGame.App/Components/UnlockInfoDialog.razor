@using CoinFlipGame.App.Models
@using CoinFlipGame.App.Models.Unlocks
@using CoinFlipGame.App.Services

<div class="unlock-info-overlay @(IsVisible ? "visible" : "")" @onclick="OnClose">
    <div class="unlock-info-dialog" @onclick:stopPropagation="true">
        @if (CoinImage != null)
        {
            <div class="unlock-info-body">
                <div class="unlock-info-coin-preview">
                    <div class="unlock-coin-silhouette">
                        <img src="@CoinImage.Path" alt="@CoinImage.DisplayName" class="unlock-coin-image" />
                        <div class="unlock-coin-overlay">
                            <span class="unlock-question-mark">?</span>
                        </div>
                    </div>
                </div>
                
                <div class="unlock-info-header">
                    <h3 class="unlock-info-title">@CoinImage.DisplayName</h3>
                    @if (CoinImage.UnlockCondition != null)
                    {
                        <div class="unlock-info-rarity @GetRarityClass()">
                            @GetRarityLabel()
                        </div>
                    }
                </div>
                
                @if (CoinImage.UnlockCondition != null)
                {
                    <div class="unlock-info-description">
                        @CoinImage.UnlockCondition.Description
                    </div>
                    
                    <div class="unlock-info-progress">
                        <div class="unlock-progress-label">Progress</div>
                        <div class="unlock-progress-bar-container">
                            <div class="unlock-progress-bar-fill" style="width: @(CalculateProgressPercentage())%"></div>
                        </div>
                        <div class="unlock-progress-text">@UnlockProgress.GetProgressDescription(CoinImage)</div>
                    </div>
                    
                    @if (CoinImage.UnlockCondition.Prerequisites != null && CoinImage.UnlockCondition.Prerequisites.Any())
                    {
                        <div class="unlock-info-prerequisites">
                            <div class="unlock-prerequisites-label">Prerequisites:</div>
                            @foreach (var prereq in CoinImage.UnlockCondition.Prerequisites)
                            {
                                <div class="unlock-prerequisite-item">
                                    <span class="unlock-prerequisite-bullet">•</span>
                                    <span>@prereq.Description</span>
                                </div>
                            }
                        </div>
                    }
                }
                
                <button class="unlock-info-close-btn" @onclick="OnClose">
                    Close
                </button>
            </div>
        }
    </div>
</div>
